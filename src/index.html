<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Orbit</title>
  <style>
    :root {
      --bg:        #0f0f0f;
      --surface:   #1a1a1a;
      --border:    #2a2a2a;
      --text:      #d4d4d4;
      --text-dim:  #777;
      --accent:    #5b8def;
      --tab-h:     48px;
      --toolbar-h: 40px;
      --radius:    8px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      user-select: none;
    }

    /* ── Tab bar ─────────────────────────────────── */
    #tab-bar {
      display: flex;
      align-items: center;
      height: var(--tab-h);
      background: var(--bg);
      padding-left: 80px;          /* room for macOS traffic lights */
      padding-top: 8px;
      padding-bottom: 4px;
      -webkit-app-region: drag;    /* draggable title bar area */
      flex-shrink: 0;
    }

    #tabs {
      display: flex;
      align-items: center;
      gap: 2px;
      height: 100%;
      -webkit-app-region: no-drag;
      overflow-x: auto;
      padding: 4px 0;
    }

    .tab {
      display: flex;
      align-items: center;
      gap: 8px;
      height: 32px;
      padding: 0 10px 0 10px;
      border-radius: 8px;
      font-size: 13px;
      color: var(--text-dim);
      background: transparent;
      border: none;
      cursor: pointer;
      white-space: nowrap;
      min-width: 140px;
      max-width: 240px;
      transition: background 0.15s, color 0.15s;
    }

    .tab:hover { background: var(--surface); color: var(--text); }

    .tab.active {
      background: var(--surface);
      color: var(--text);
    }

    .tab-favicon {
      width: 14px;
      height: 14px;
      flex-shrink: 0;
      border-radius: 2px;
    }

    .tab-spinner {
      width: 14px;
      height: 14px;
      flex-shrink: 0;
      border: 2px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.7s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .tab-title {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      text-align: left;
      min-width: 0;
    }

    .tab-close {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      border-radius: 4px;
      font-size: 14px;
      line-height: 1;
      color: var(--text-dim);
      opacity: 0;
      flex-shrink: 0;
      transition: opacity 0.1s, background 0.1s;
    }

    .tab:hover .tab-close { opacity: 1; }
    .tab-close:hover { background: rgba(255,255,255,0.1); color: var(--text); }

    #btn-reload.spinning svg {
      animation: spin 0.8s linear infinite;
    }

    #new-tab-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      border-radius: 6px;
      font-size: 18px;
      color: var(--text-dim);
      background: none;
      border: none;
      cursor: pointer;
      -webkit-app-region: no-drag;
      transition: background 0.15s, color 0.15s;
      flex-shrink: 0;
    }

    #new-tab-btn:hover { background: var(--surface); color: var(--text); }

    /* ── Toolbar (address bar) ───────────────────── */
    #toolbar {
      display: flex;
      align-items: center;
      gap: 6px;
      height: var(--toolbar-h);
      padding: 0 12px;
      background: var(--bg);
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }

    .nav-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: none;
      border: none;
      cursor: pointer;
      transition: background 0.15s;
      flex-shrink: 0;
    }
    .nav-btn svg { width: 16px; height: 16px; stroke: var(--text-dim); fill: none; stroke-width: 1.8; stroke-linecap: round; stroke-linejoin: round; transition: stroke 0.15s; }
    .nav-btn:hover { background: var(--surface); }
    .nav-btn:hover svg { stroke: var(--text); }
    .nav-btn:disabled { opacity: 0.3; cursor: default; }
    .nav-btn:disabled:hover { background: none; }
    .nav-btn:disabled:hover svg { stroke: var(--text-dim); }

    #btn-agent svg { stroke: none; fill: var(--text-dim); width: 18px; height: 18px; }
    #btn-agent:hover svg { fill: var(--text); }
    #btn-agent.active svg { fill: var(--accent); }

    #btn-menu svg { stroke: none; fill: var(--text-dim); width: 18px; height: 18px; }
    #btn-menu:hover svg { fill: var(--text); }

    /* ── Dropdown menu ───────────────────────────── */
    .menu-anchor { position: relative; }

    #dropdown-menu {
      display: none;
      position: absolute;
      top: 36px;
      right: 0;
      width: 240px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 6px 0;
      box-shadow: 0 8px 24px rgba(0,0,0,0.5);
      z-index: 100;
    }

    #dropdown-menu.open { display: block; }

    .menu-anchor.is-open { z-index: 101; position: relative; }

    #dropdown-overlay {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 100;
      background: transparent;
      cursor: default;
    }
    #dropdown-overlay.visible { display: block; }

    .menu-row {
      display: flex;
      align-items: center;
      height: 36px;
      padding: 0 12px;
      gap: 4px;
    }

    .menu-row-label {
      font-size: 13px;
      color: var(--text);
      margin-right: auto;
    }

    .zoom-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      border-radius: 6px;
      background: none;
      border: none;
      color: var(--text);
      font-size: 15px;
      cursor: pointer;
      transition: background 0.12s;
    }

    .zoom-btn:hover { background: rgba(255,255,255,0.1); }

    #zoom-level {
      min-width: 40px;
      text-align: center;
      font-size: 12px;
      color: var(--text-dim);
      cursor: default;
    }

    .menu-divider {
      height: 1px;
      background: var(--border);
      margin: 4px 0;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      height: 36px;
      padding: 0 14px;
      background: none;
      border: none;
      color: var(--text);
      font-size: 13px;
      cursor: pointer;
      transition: background 0.12s;
    }
    .menu-item:hover { background: rgba(255,255,255,0.06); }
    .menu-item svg { width: 16px; height: 16px; fill: var(--text-dim); flex-shrink: 0; }

    .url-bar-wrapper {
      flex: 1;
      position: relative;
    }

    .url-bar-autocomplete {
      position: absolute;
      left: 14px;
      top: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      pointer-events: none;
      font-size: 13px;
      font-family: inherit;
      color: var(--text-dim);
      white-space: pre;
      overflow: hidden;
      max-width: calc(100% - 28px);
    }

    #url-bar {
      width: 100%;
      height: 32px;
      padding: 0 14px;
      border-radius: 16px;
      border: none;
      background: var(--surface);
      color: var(--text);
      font-size: 13px;
      outline: none;
      transition: background 0.2s, box-shadow 0.2s;
    }

    #url-bar:focus { background: var(--bg); box-shadow: 0 0 0 2px var(--accent); }

    /* ── Omnibox suggestions ─────────────────────── */
    #suggestions {
      display: none;
      position: absolute;
      top: 38px;
      left: 0;
      right: 0;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 4px 0;
      box-shadow: 0 8px 28px rgba(0,0,0,0.55);
      z-index: 200;
      max-height: 360px;
      overflow-y: auto;
    }

    #suggestions.open { display: block; }

    .suggestion {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 14px;
      cursor: pointer;
      transition: background 0.1s;
    }

    .suggestion:hover,
    .suggestion.selected { background: rgba(255,255,255,0.06); }

    .suggestion-icon {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .suggestion-icon svg { width: 14px; height: 14px; stroke: var(--text-dim); fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
    .suggestion-icon.history-icon svg { stroke: var(--text-dim); }
    .suggestion-icon.search-icon svg { stroke: var(--accent); }

    .suggestion-text {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 1px;
    }

    .suggestion-title {
      font-size: 13px;
      color: var(--text);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .suggestion-title strong,
    .suggestion-url strong {
      font-weight: 600;
      color: var(--text);
    }

    .suggestion-url {
      font-size: 11px;
      color: var(--text-dim);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* ── Chat page ────────────────────────────────── */
    .chat-page {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      background: var(--bg);
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 32px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .chat-messages-inner {
      flex: 1;
      width: 100%;
      max-width: 680px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      min-height: 0;
    }

    .chat-welcome-block {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex: 1;
      min-height: 0;
      padding: 48px 0;
    }

    .chat-welcome {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      width: 100%;
      max-width: 560px;
    }

    .chat-welcome h1 {
      font-size: 28px;
      font-weight: 600;
      color: var(--text);
      text-align: center;
    }

    .chat-welcome p {
      font-size: 15px;
      color: var(--text-dim);
      text-align: center;
    }

    .chat-welcome-block .chat-input-area {
      margin-top: 32px;
      width: 100%;
      max-width: 560px;
      padding: 0;
    }

    .chat-input-footer {
      flex-shrink: 0;
      display: flex;
      justify-content: center;
      padding: 16px 24px 24px;
    }

    .chat-input-footer .chat-input-area {
      width: 100%;
      max-width: 560px;
    }

    .chat-msg {
      display: flex;
      gap: 12px;
      font-size: 14px;
      line-height: 1.6;
    }

    .chat-msg-avatar {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 600;
    }

    .chat-msg.user .chat-msg-avatar {
      background: var(--accent);
      color: #fff;
    }

    .chat-msg.assistant .chat-msg-avatar {
      background: var(--surface);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .chat-msg-body {
      flex: 1;
      min-width: 0;
      padding-top: 4px;
      color: var(--text);
    }

    .chat-input-area {
      flex-shrink: 0;
      display: flex;
      justify-content: center;
    }

    .chat-input-box {
      display: flex;
      align-items: flex-end;
      gap: 0;
      width: 100%;
      max-width: 560px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 6px 6px 6px 6px;
      transition: border-color 0.2s;
    }

    .chat-input-box:focus-within { border-color: var(--accent); }

    .chat-attach-btn,
    .chat-send-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 34px;
      height: 34px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      flex-shrink: 0;
      transition: background 0.12s;
    }

    .chat-attach-btn {
      background: none;
    }
    .chat-attach-btn svg { width: 18px; height: 18px; stroke: var(--text-dim); fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
    .chat-attach-btn:hover { background: rgba(255,255,255,0.06); }

    .chat-send-btn {
      background: var(--accent);
    }
    .chat-send-btn svg { width: 16px; height: 16px; stroke: #fff; fill: none; stroke-width: 2.2; stroke-linecap: round; stroke-linejoin: round; }
    .chat-send-btn:hover { background: #4a7de0; }
    .chat-send-btn:disabled { opacity: 0.4; cursor: default; }
    .chat-send-btn:disabled:hover { background: var(--accent); }

    .chat-textarea {
      flex: 1;
      border: none;
      background: none;
      color: var(--text);
      font-family: inherit;
      font-size: 14px;
      line-height: 1.5;
      resize: none;
      outline: none;
      padding: 6px 8px;
      min-height: 22px;
      max-height: 160px;
    }

    .chat-textarea::placeholder { color: var(--text-dim); }

    /* ── Main content (webview + agent panel) ────── */
    #main-content {
      flex: 1;
      display: flex;
      min-height: 0;
      overflow: hidden;
    }

    #webview-container {
      flex: 1;
      position: relative;
      background: #fff;
      min-width: 0;
    }

    .agent-resize-handle {
      flex-shrink: 0;
      width: 6px;
      background: transparent;
      cursor: col-resize;
      transition: background 0.15s;
      opacity: 0;
      pointer-events: none;
    }
    #main-content:has(.agent-panel.open) .agent-resize-handle {
      opacity: 1;
      pointer-events: auto;
    }
    .agent-resize-handle:hover,
    .agent-resize-handle.resizing { background: var(--accent); opacity: 0.4; }

    .agent-panel {
      flex-shrink: 0;
      width: 0;
      min-width: 0;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      background: var(--bg);
      border-left: 1px solid var(--border);
      transition: width 0.2s ease;
    }
    .agent-panel.open {
      width: var(--agent-panel-width, 20%);
      min-width: 200px;
      max-width: 50%;
    }
    .agent-panel.resizing { transition: none; }

    #main-content.resizing webview,
    #main-content.resizing .internal-page { pointer-events: none; }

    .agent-panel-header {
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 44px;
      padding: 0 16px;
      border-bottom: 1px solid var(--border);
    }
    .agent-panel-title { font-size: 14px; font-weight: 600; color: var(--text); }
    .agent-panel-close {
      width: 28px; height: 28px;
      border-radius: 6px;
      border: none;
      background: none;
      color: var(--text-dim);
      font-size: 18px;
      line-height: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.12s, color 0.12s;
    }
    .agent-panel-close:hover { background: var(--surface); color: var(--text); }

    .agent-panel-messages {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .agent-welcome {
      display: flex;
      flex-direction: column;
      gap: 4px;
      padding: 24px 0;
    }
    .agent-welcome p { font-size: 15px; font-weight: 500; color: var(--text); }
    .agent-welcome span { font-size: 13px; color: var(--text-dim); }

    .agent-msg {
      display: flex;
      gap: 10px;
      font-size: 14px;
      line-height: 1.6;
    }
    .agent-msg-avatar {
      width: 24px; height: 24px;
      border-radius: 50%;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
    }
    .agent-msg.user .agent-msg-avatar { background: var(--accent); color: #fff; }
    .agent-msg.assistant .agent-msg-avatar { background: var(--surface); color: var(--text); border: 1px solid var(--border); }
    .agent-msg-body { flex: 1; min-width: 0; color: var(--text); }

    .agent-panel-input-area {
      flex-shrink: 0;
      padding: 12px 16px 16px;
      border-top: 1px solid var(--border);
    }
    .agent-input-box { max-width: none !important; }

    /* ── Webview container (children) ─────────────── */

    #webview-container webview,
    #webview-container .internal-page {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: none;
    }

    #webview-container webview.active,
    #webview-container .internal-page.active {
      display: flex;
    }

    .internal-page {
      background: var(--bg);
      color: #d4d4d4;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      overflow: hidden;
      flex-direction: row;
    }

    .internal-page > .chat-page {
      flex: 1;
      min-width: 0;
    }

    /* ── Settings layout ─────────────────────────── */
    .settings-layout {
      display: flex;
      width: 100%;
      height: 100%;
    }

    .settings-sidebar {
      width: 220px;
      flex-shrink: 0;
      background: var(--surface);
      padding: 24px 0;
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .settings-sidebar-title {
      font-size: 18px;
      font-weight: 600;
      padding: 0 20px 16px;
      color: var(--text);
    }

    .settings-nav-item {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      height: 38px;
      padding: 0 20px;
      background: none;
      border: none;
      color: var(--text-dim);
      font-size: 13px;
      cursor: pointer;
      transition: background 0.12s, color 0.12s;
      text-align: left;
    }
    .settings-nav-item:hover { background: rgba(255,255,255,0.04); color: var(--text); }
    .settings-nav-item.active { background: rgba(255,255,255,0.06); color: var(--text); }
    .settings-nav-item svg { width: 16px; height: 16px; fill: currentColor; flex-shrink: 0; }

    .settings-content {
      flex: 1;
      padding: 32px 48px;
      overflow-y: auto;
      min-height: 0;
    }

    .settings-panel-centered {
      min-height: 100%;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .settings-panel-centered-inner {
      width: 100%;
      max-width: 480px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .settings-panel-centered-inner .settings-content-header {
      justify-content: center;
    }
    .settings-panel-centered-inner .settings-content-header h2 {
      text-align: center;
    }
    .settings-panel-centered-inner .settings-field {
      width: 100%;
      text-align: center;
    }
    .settings-panel-centered-inner .settings-field-label {
      text-align: center;
    }
    .settings-panel-centered-inner .settings-field-row {
      justify-content: center;
      width: 100%;
    }
    .settings-panel-centered-inner .settings-field-hint {
      text-align: center;
    }
    .settings-panel-centered-inner .vault-description {
      text-align: center;
    }
    .settings-panel-centered-inner .home-page-presets {
      justify-content: center;
    }
    .settings-panel-centered-inner .settings-input {
      max-width: 320px;
      text-align: center;
    }
    .settings-panel-centered-inner .settings-field-row .settings-input {
      flex: 0 1 320px;
    }
    .settings-field-inline .settings-field-row {
      gap: 12px;
    }
    .settings-field-inline .settings-field-label {
      margin-bottom: 0;
      min-width: 140px;
      flex-shrink: 0;
    }

    .settings-content-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .settings-content-header h2 {
      font-size: 22px;
      font-weight: 600;
      color: var(--text);
    }

    .settings-btn {
      padding: 7px 16px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: none;
      color: var(--text);
      font-size: 13px;
      cursor: pointer;
      transition: background 0.12s;
    }
    .settings-btn:hover { background: rgba(255,255,255,0.06); }
    .settings-btn.danger { border-color: #c44; color: #e66; }
    .settings-btn.danger:hover { background: rgba(204,68,68,0.15); }

    .settings-field {
      max-width: 480px;
      margin-top: 8px;
    }
    .settings-field-label {
      display: block;
      font-size: 13px;
      color: var(--text-dim);
      margin-bottom: 8px;
    }
    .settings-field-row {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    .settings-input {
      flex: 1;
      height: 36px;
      padding: 0 12px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text);
      font-size: 13px;
      outline: none;
      transition: border-color 0.15s;
    }
    .settings-input:focus { border-color: var(--accent); }
    .settings-input::placeholder { color: var(--text-dim); }
    .settings-field-hint {
      font-size: 12px;
      color: var(--text-dim);
      margin-top: 8px;
    }

    .home-page-presets {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }
    .home-preset-btn {
      padding: 8px 14px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: none;
      color: var(--text-dim);
      font-size: 13px;
      cursor: pointer;
      transition: background 0.12s, color 0.12s, border-color 0.12s;
    }
    .home-preset-btn:hover { background: rgba(255,255,255,0.04); color: var(--text); }
    .home-preset-btn.active { border-color: var(--accent); color: var(--accent); background: rgba(91,141,239,0.1); }

    /* ── History actions ─────────────────────────── */
    .history-actions {
      display: flex;
      gap: 6px;
      align-items: center;
    }
    .history-icon-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 34px;
      height: 34px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: none;
      color: var(--text-dim);
      cursor: pointer;
      transition: background 0.12s, color 0.12s, border-color 0.12s;
    }
    .history-icon-btn:hover {
      background: rgba(255,255,255,0.06);
      color: var(--text);
    }
    .history-icon-btn svg {
      width: 16px;
      height: 16px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .history-icon-btn-danger:hover {
      border-color: #c44;
      color: #e66;
      background: rgba(204,68,68,0.1);
    }

    /* ── Confirmation modal ──────────────────────── */
    .confirm-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }
    .confirm-modal.open {
      display: flex;
    }
    .confirm-modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(4px);
    }
    .confirm-modal-dialog {
      position: relative;
      width: 100%;
      max-width: 380px;
      padding: 28px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: 0 24px 48px rgba(0,0,0,0.5);
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    .confirm-modal-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 16px;
    }
    .confirm-modal-icon svg {
      width: 24px;
      height: 24px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .confirm-modal-icon-danger {
      background: rgba(204,68,68,0.15);
      color: #e66;
    }
    .confirm-modal-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 8px;
    }
    .confirm-modal-message {
      font-size: 13px;
      color: var(--text-dim);
      line-height: 1.5;
      margin-bottom: 24px;
    }
    .confirm-modal-actions {
      display: flex;
      gap: 12px;
      width: 100%;
      justify-content: center;
    }
    .confirm-modal-btn {
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.12s, border-color 0.12s;
    }
    .confirm-modal-cancel {
      border: 1px solid var(--border);
      background: none;
      color: var(--text);
    }
    .confirm-modal-cancel:hover {
      background: rgba(255,255,255,0.06);
    }
    .confirm-modal-confirm {
      border: 1px solid #c44;
      background: #c44;
      color: #fff;
    }
    .confirm-modal-confirm:hover {
      background: #b33;
      border-color: #b33;
    }

    /* ── History pagination ──────────────────────── */
    .history-pagination {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: center;
    }
    .history-pagination-nav {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .history-pagination-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: none;
      color: var(--text-dim);
      cursor: pointer;
      transition: background 0.12s, color 0.12s;
    }
    .history-pagination-btn:hover:not(:disabled) {
      background: rgba(255,255,255,0.06);
      color: var(--text);
    }
    .history-pagination-btn:disabled {
      opacity: 0.3;
      cursor: default;
    }
    .history-pagination-btn svg {
      width: 16px;
      height: 16px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .history-pagination-pages {
      display: flex;
      gap: 4px;
      margin: 0 8px;
    }
    .history-pagination-page {
      min-width: 32px;
      height: 32px;
      padding: 0 8px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: none;
      color: var(--text-dim);
      font-size: 13px;
      cursor: pointer;
      transition: background 0.12s, color 0.12s, border-color 0.12s;
    }
    .history-pagination-page:hover {
      background: rgba(255,255,255,0.06);
      color: var(--text);
    }
    .history-pagination-page.active {
      border-color: var(--accent);
      background: rgba(91,141,239,0.15);
      color: var(--accent);
    }

    /* ── History list ────────────────────────────── */
    .history-list {
      list-style: none;
    }

    .history-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
      font-size: 13px;
    }

    .history-item:last-child { border-bottom: none; }

    .history-time {
      color: var(--text-dim);
      font-size: 12px;
      flex-shrink: 0;
      width: 110px;
    }

    .history-info {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .history-title {
      color: var(--text);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      font-size: 13px;
    }

    .history-url {
      color: var(--accent);
      font-size: 12px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      cursor: pointer;
      text-decoration: none;
    }
    .history-url:hover { text-decoration: underline; }

    .history-empty {
      color: var(--text-dim);
      font-size: 13px;
      padding: 24px 0;
    }

    .history-load-more.loading {
      color: var(--text-dim);
      font-size: 13px;
      padding: 16px 0;
      visibility: visible !important;
    }

    /* ── File Vault ───────────────────────────────── */
    .vault-header {
      margin-bottom: 4px;
    }
    .vault-upload-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .vault-upload-btn svg {
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .vault-description {
      color: var(--text-dim);
      font-size: 13px;
      margin-bottom: 24px;
    }
    .vault-files {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
    }
    .vault-loading {
      color: var(--text-dim);
      font-size: 13px;
      padding: 24px 0;
    }
    .vault-file-card {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 6px;
      padding: 16px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text);
      cursor: pointer;
      text-align: left;
      transition: border-color 0.15s, background 0.15s, transform 0.12s;
    }
    .vault-file-card:hover {
      border-color: var(--accent);
      background: rgba(91, 141, 239, 0.08);
      transform: translateY(-1px);
    }
    .vault-file-icon-wrap {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      background: rgba(91, 141, 239, 0.15);
      margin-bottom: 4px;
    }
    .vault-file-icon-wrap .vault-file-icon {
      width: 22px;
      height: 22px;
      stroke: var(--accent);
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .vault-file-name {
      font-size: 13px;
      font-weight: 500;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      max-width: 100%;
    }
    .vault-file-date {
      font-size: 11px;
      color: var(--text-dim);
    }
    .vault-file-action {
      font-size: 12px;
      color: var(--accent);
      margin-top: auto;
      opacity: 0;
      transition: opacity 0.15s;
    }
    .vault-file-card:hover .vault-file-action {
      opacity: 1;
    }
    .vault-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 48px 24px;
      text-align: center;
    }
    .vault-empty-icon {
      width: 64px;
      height: 64px;
      margin-bottom: 16px;
      border-radius: 16px;
      background: rgba(255,255,255,0.04);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .vault-empty-icon svg {
      width: 32px;
      height: 32px;
      stroke: var(--text-dim);
      fill: none;
      stroke-width: 1.5;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .vault-empty p {
      font-size: 15px;
      color: var(--text);
      margin-bottom: 4px;
    }
    .vault-empty span {
      font-size: 13px;
      color: var(--text-dim);
    }
  </style>
</head>
<body>

  <!-- Tab bar -->
  <div id="tab-bar">
    <div id="tabs"></div>
    <button id="new-tab-btn" title="New Tab">+</button>
  </div>

  <!-- Toolbar -->
  <div id="toolbar">
    <button class="nav-btn" id="btn-back" title="Back">
      <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
    </button>
    <button class="nav-btn" id="btn-forward" title="Forward">
      <svg viewBox="0 0 24 24"><path d="M9 6l6 6-6 6"/></svg>
    </button>
    <button class="nav-btn" id="btn-reload" title="Reload">
      <svg viewBox="0 0 24 24"><path d="M23 4v6h-6"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>
    </button>
    <button class="nav-btn" id="btn-home" title="Home">
      <svg viewBox="0 0 24 24"><path d="M3 12l2-2m0 0l7-7 7 7m-14 0v9a1 1 0 0 0 1 1h3m10-10l2 2m-2-2v9a1 1 0 0 1-1 1h-3m-4 0a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-2z"/></svg>
    </button>
    <div class="url-bar-wrapper">
      <div class="url-bar-autocomplete" id="url-bar-autocomplete"></div>
      <input id="url-bar" type="text" placeholder="Search or enter URL" spellcheck="false" autocomplete="off" />
      <div id="suggestions"></div>
    </div>
    <button class="nav-btn" id="btn-agent" title="Agent">
      <svg viewBox="0 0 24 24"><path d="M20 9V7c0-1.1-.9-2-2-2h-3c0-1.66-1.34-3-3-3S9 3.34 9 5H6c-1.1 0-2 .9-2 2v2c-1.66 0-3 1.34-3 3s1.34 3 3 3v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c1.66 0 3-1.34 3-3s-1.34-3-3-3zm0 4c-.55 0-1 .45-1 1v5H5v-5c0-.55-.45-1-1-1s-1-.45-1-1 .45-1 1-1h1V7h12v5h1c.55 0 1 .45 1 1s-.45 1-1 1zM9 14c.83 0 1.5-.67 1.5-1.5S9.83 11 9 11s-1.5.67-1.5 1.5S8.17 14 9 14zm6 0c.83 0 1.5-.67 1.5-1.5S15.83 11 15 11s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-7 2h8v2H8z"/></svg>
    </button>
    <div id="dropdown-overlay"></div>
    <div class="menu-anchor" id="menu-anchor">
      <button class="nav-btn" id="btn-menu" title="Menu">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="5" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="12" cy="19" r="2"/></svg>
      </button>
      <div id="dropdown-menu">
        <button class="menu-item" id="menu-new-tab">
          <svg viewBox="0 0 24 24" style="fill:none;stroke:var(--text-dim);stroke-width:2;stroke-linecap:round"><path d="M12 5v14m-7-7h14"/></svg>
          New Tab
        </button>
        <button class="menu-item" id="menu-new-window">
          <svg viewBox="0 0 24 24" style="fill:none;stroke:var(--text-dim);stroke-width:2;stroke-linecap:round;stroke-linejoin:round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>
          New Window
        </button>
        <div class="menu-divider"></div>
        <div class="menu-row">
          <span class="menu-row-label">Zoom</span>
          <button class="zoom-btn" id="menu-zoom-out" title="Zoom out">&minus;</button>
          <span id="zoom-level">100%</span>
          <button class="zoom-btn" id="menu-zoom-in" title="Zoom in">+</button>
        </div>
        <div class="menu-divider"></div>
        <button class="menu-item" id="menu-settings">
          <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.49.49 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.48.48 0 0 0-.48-.41h-3.84a.48.48 0 0 0-.48.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.49.49 0 0 0-.59.22L2.74 8.87a.48.48 0 0 0 .12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6A3.6 3.6 0 1 1 12 8.4a3.6 3.6 0 0 1 0 7.2z"/></svg>
          Settings
        </button>
      </div>
    </div>
  </div>

  <!-- Main content: webview + agent panel -->
  <div id="main-content">
    <div id="webview-container"></div>
    <div class="agent-resize-handle" id="agent-resize-handle" title="Drag to resize"></div>
    <div class="agent-panel" id="agent-panel">
      <div class="agent-panel-header">
        <span class="agent-panel-title">Orbit</span>
        <button class="agent-panel-close" id="agent-panel-close" title="Close">×</button>
      </div>
      <div class="agent-panel-messages" id="agent-panel-messages">
        <div class="agent-welcome">
          <p>How can I help?</p>
          <span>Ask about the page you're viewing or anything else.</span>
        </div>
      </div>
      <div class="agent-panel-input-area">
        <div class="chat-input-box agent-input-box">
          <button class="chat-attach-btn" title="Attach">
            <svg viewBox="0 0 24 24"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
          </button>
          <textarea class="chat-textarea" id="agent-input" placeholder="Message Orbit..." rows="1"></textarea>
          <button class="chat-send-btn" id="agent-send-btn" title="Send" disabled>
            <svg viewBox="0 0 24 24"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
